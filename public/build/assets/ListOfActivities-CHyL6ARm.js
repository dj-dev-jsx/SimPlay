import{r as i,j as e,H as L,L as P,c as N}from"./app-0DF_PI_u.js";import{T as $}from"./TeacherLayout-D-As82_F.js";import{D as r,b as d,c as o,d as h,e as b}from"./dialog-D-oqYZ02.js";import{B as a}from"./button-CDiGTA5k.js";import{P as q}from"./plus-DXZ4fNby.js";import{c as A}from"./user-Cm5WI2hM.js";import"./smile-rxgOplyq.js";import"./log-out-BEqe53Sh.js";const B=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"m9 9.5 2 2 4-4",key:"1dth82"}]],z=A("book-check",B);const I=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],R=A("square-pen",I);const U=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],V=A("trash",U);function ee({classroom:p,activities:k}){const[w,g]=i.useState(k||[]),[c,O]=i.useState(null),[S,f]=i.useState(!1),[D,j]=i.useState(!1),[_,u]=i.useState(!1),[M,m]=i.useState(!1),[F,x]=i.useState(!1),[H,y]=i.useState(""),[s,n]=i.useState({id:null,title:"",instructions:"",image:null}),T=async()=>{try{const t=new FormData;t.append("title",s.title),t.append("instructions",s.instructions),s.image&&t.append("image",s.image);let l;s.id?(l=await N.post(route("teacher.update_activity",s.id),t,{headers:{"Content-Type":"multipart/form-data"}}),g(v=>v.map(C=>C.id===l.data.activity.id?l.data.activity:C)),y("Activity updated successfully!")):(l=await N.post(route("teacher.store_activity",p.id),t,{headers:{"Content-Type":"multipart/form-data"}}),g(v=>[l.data.activity,...v]),y("Activity added successfully!")),f(!1),j(!1),u(!1),x(!0),n({id:null,title:"",instructions:"",image:null})}catch(t){console.error(t),alert("Failed to save activity. Please try again.")}},E=async()=>{try{await N.delete(route("teacher.delete_activity",s.id)),g(t=>t.filter(l=>l.id!==s.id)),m(!1),y("Activity deleted successfully!"),x(!0)}catch(t){console.error(t),alert("Failed to delete activity. Please try again.")}};return e.jsxs($,{children:[e.jsx(L,{title:`${p.name} – Activities`}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-green-700",children:[p.name," – Activities"]}),e.jsx("p",{className:"text-gray-600",children:"Manage class activities"})]}),e.jsxs(a,{onClick:()=>f(!0),className:"bg-green-600 hover:bg-green-700 flex gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"Add Activity"]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(t=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[e.jsx("img",{src:`/storage/${t.image_path}`,className:"h-48 w-full object-cover"}),e.jsxs("div",{className:"p-4 flex flex-col gap-2",children:[e.jsx("h2",{className:"font-semibold text-green-800",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:t.instructions}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(a,{asChild:!0,className:"flex-1 bg-purple-600 flex items-center justify-center gap-2",children:e.jsxs(P,{href:route("teacher.activity.records",t.id),children:[e.jsx(z,{className:"h-4 w-4"}),"Records"]})}),e.jsxs(a,{onClick:()=>{n({id:t.id,title:t.title,instructions:t.instructions,image:null}),j(!0)},className:"flex-1 bg-yellow-500 flex items-center justify-center gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),"Edit"]}),e.jsxs(a,{onClick:()=>{n({id:t.id}),m(!0)},className:"flex-1 bg-red-600 flex items-center justify-center gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),"Delete"]})]})]})]},t.id))}),e.jsx(r,{open:!!c,onOpenChange:()=>O(null),children:e.jsx(d,{className:"max-w-4xl",children:c&&e.jsxs(e.Fragment,{children:[e.jsx(o,{children:e.jsx(h,{className:"text-green-700",children:c.title})}),e.jsx("p",{className:"text-gray-700",children:c.instructions}),e.jsx("img",{src:`/storage/${c.image_path}`,className:"w-full max-h-[70vh] object-contain rounded-xl border mt-4"})]})})}),e.jsx(r,{open:S||D,onOpenChange:()=>{f(!1),j(!1)},children:e.jsxs(d,{children:[e.jsx(o,{children:e.jsx(h,{children:s.id?"Edit Activity":"Add Activity"})}),e.jsxs("form",{onSubmit:t=>{t.preventDefault(),u(!0)},className:"space-y-4 mt-2",children:[e.jsx("input",{className:"w-full border rounded-lg p-2",placeholder:"Activity Title",value:s.title,onChange:t=>n({...s,title:t.target.value}),required:!0}),e.jsx("textarea",{className:"w-full border rounded-lg p-2",placeholder:"Instructions",value:s.instructions,onChange:t=>n({...s,instructions:t.target.value})}),e.jsx("input",{type:"file",accept:"image/*",onChange:t=>n({...s,image:t.target.files[0]})}),e.jsx(a,{type:"submit",className:"w-full bg-green-600",children:s.id?"Update Activity":"Save Activity"})]})]})}),e.jsx(r,{open:_,onOpenChange:u,children:e.jsxs(d,{children:[e.jsx(o,{children:e.jsxs(h,{children:["Confirm ",s.id?"Update":"Add"," Activity"]})}),e.jsxs("p",{children:["Are you sure you want to ",s.id?"update":"add"," this activity?"]}),e.jsxs(b,{className:"flex justify-end gap-2 mt-4",children:[e.jsx(a,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),e.jsx(a,{onClick:T,className:"bg-green-600",children:"Confirm"})]})]})}),e.jsx(r,{open:M,onOpenChange:m,children:e.jsxs(d,{children:[e.jsx(o,{children:e.jsx(h,{children:"Delete Activity"})}),e.jsx("p",{children:"Are you sure you want to delete this activity? This action cannot be undone."}),e.jsxs(b,{className:"flex justify-end gap-2 mt-4",children:[e.jsx(a,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(a,{className:"bg-red-600",onClick:E,children:"Delete"})]})]})}),e.jsx(r,{open:F,onOpenChange:()=>x(!1),children:e.jsxs(d,{children:[e.jsx(o,{children:e.jsx(h,{children:"Success!"})}),e.jsx("p",{children:H}),e.jsx(b,{className:"flex justify-end mt-4",children:e.jsx(a,{className:"bg-green-600",onClick:()=>x(!1),children:"OK"})})]})})]})]})}export{ee as default};
