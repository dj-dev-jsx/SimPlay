import{r as l,j as e,H,L as E,c as y}from"./app-DduNe8A5.js";import{T as L}from"./TeacherLayout-D9KQ-Uk2.js";import{D as d,a as u,b as p,c as h,d as N}from"./dialog-BY4i_fJS.js";import{B as a}from"./button-w8xTxRNV.js";import{P as M}from"./plus-DUcSwPfy.js";import{c as P}from"./user-BOvaNEfT.js";import{S as B,T as I}from"./trash-B2ooUwA-.js";import"./log-out-B1oHdiJS.js";const R=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"m9 9.5 2 2 4-4",key:"1dth82"}]],q=P("book-check",R);function W({classroom:x,activities:C}){const[w,m]=l.useState(C||[]),[A,f]=l.useState(!1),[k,g]=l.useState(!1),[O,c]=l.useState(!1),[S,r]=l.useState(!1),[D,o]=l.useState(!1),[_,j]=l.useState(""),[s,i]=l.useState({id:null,title:"",introduction:"",instructions:"",category:"",image:null}),T=async()=>{try{const t=new FormData;t.append("title",s.title),t.append("introduction",s.introduction),t.append("instructions",s.instructions),t.append("category",s.category),s.image&&t.append("image",s.image);let n;s.id?(n=await y.post(route("teacher.update_activity",s.id),t,{headers:{"Content-Type":"multipart/form-data"}}),m(v=>v.map(b=>b.id===n.data.activity.id?n.data.activity:b)),j("Activity updated successfully!")):(n=await y.post(route("teacher.store_activity",x.id),t,{headers:{"Content-Type":"multipart/form-data"}}),m(v=>[n.data.activity,...v]),j("Activity added successfully!")),f(!1),g(!1),c(!1),o(!0),i({id:null,title:"",introduction:"",instructions:"",category:"",image:null})}catch(t){console.error(t),alert("Failed to save activity.")}},F=async()=>{try{await y.delete(route("teacher.delete_activity",s.id)),m(t=>t.filter(n=>n.id!==s.id)),r(!1),j("Activity deleted successfully!"),o(!0)}catch(t){console.error(t),alert("Failed to delete activity.")}};return e.jsxs(L,{children:[e.jsx(H,{title:`${x.name} – Activities`}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-green-700",children:[x.name," – Activities"]}),e.jsx("p",{className:"text-gray-600",children:"Manage class activities"})]}),e.jsxs(a,{onClick:()=>f(!0),className:"bg-green-600 hover:bg-green-700 flex gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),"Add Activity"]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(t=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[e.jsx("img",{src:`/${t.image_path}`,className:"h-48 w-full object-cover"}),e.jsxs("div",{className:"p-4 flex flex-col gap-2",children:[e.jsx("h2",{className:"font-semibold text-green-800",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:t.introduction}),e.jsx("span",{className:"text-xs font-semibold text-green-600 uppercase",children:t.category?.replace("_"," ")}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[t.category!=="reference"&&e.jsx(a,{asChild:!0,className:"w-full sm:flex-1 bg-purple-600 flex items-center justify-center gap-1",children:e.jsxs(E,{href:route("teacher.activity.records",t.id),children:[e.jsx(q,{className:"h-4 w-4"}),"Records"]})}),e.jsxs(a,{onClick:()=>{i({id:t.id,title:t.title,introduction:t.introduction??"",instructions:t.instructions??"",category:t.category??"",image:null}),g(!0)},className:"w-full sm:flex-1 bg-yellow-500 flex items-center justify-center gap-1",children:[e.jsx(B,{className:"h-4 w-4"}),"Edit"]}),e.jsxs(a,{onClick:()=>{i({id:t.id}),r(!0)},className:"w-full sm:flex-1 bg-red-600 flex items-center justify-center gap-1",children:[e.jsx(I,{className:"h-4 w-4"}),"Delete"]})]})]})]},t.id))}),e.jsx(d,{open:A||k,onOpenChange:()=>{f(!1),g(!1)},children:e.jsxs(u,{children:[e.jsx(p,{children:e.jsx(h,{children:s.id?"Edit Activity":"Add Activity"})}),e.jsxs("form",{onSubmit:t=>{t.preventDefault(),c(!0)},className:"space-y-4",children:[e.jsx("input",{className:"w-full border rounded-lg p-2",placeholder:"Activity Title",value:s.title,onChange:t=>i({...s,title:t.target.value}),required:!0}),e.jsx("textarea",{className:"w-full border rounded-lg p-2",placeholder:"Introduction",rows:3,value:s.introduction,onChange:t=>i({...s,introduction:t.target.value})}),e.jsx("textarea",{className:"w-full border rounded-lg p-2",placeholder:"Instructions",rows:4,value:s.instructions,onChange:t=>i({...s,instructions:t.target.value})}),e.jsxs("select",{className:"w-full border rounded-lg p-2",value:s.category,onChange:t=>i({...s,category:t.target.value}),children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"pre_activity",children:"Pre-Activity"}),e.jsx("option",{value:"concept_activity",children:"Concept Activity"}),e.jsx("option",{value:"application",children:"Application"}),e.jsx("option",{value:"reference",children:"Reference"})]}),e.jsx("input",{type:"file",accept:"image/*",onChange:t=>i({...s,image:t.target.files[0]})}),e.jsx(a,{type:"submit",className:"w-full bg-green-600",children:s.id?"Update Activity":"Save Activity"})]})]})}),e.jsx(d,{open:O,onOpenChange:c,children:e.jsxs(u,{children:[e.jsx(p,{children:e.jsx(h,{children:"Confirm Action"})}),e.jsx("p",{children:"Are you sure you want to proceed?"}),e.jsxs(N,{className:"flex justify-end gap-2",children:[e.jsx(a,{variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsx(a,{onClick:T,className:"bg-green-600",children:"Confirm"})]})]})}),e.jsx(d,{open:S,onOpenChange:r,children:e.jsxs(u,{children:[e.jsx(p,{children:e.jsx(h,{children:"Delete Activity"})}),e.jsx("p",{children:"This action cannot be undone."}),e.jsxs(N,{className:"flex justify-end gap-2",children:[e.jsx(a,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(a,{onClick:F,className:"bg-red-600",children:"Delete"})]})]})}),e.jsx(d,{open:D,onOpenChange:o,children:e.jsxs(u,{children:[e.jsx(p,{children:e.jsx(h,{children:"Success"})}),e.jsx("p",{children:_}),e.jsx(N,{className:"flex justify-end",children:e.jsx(a,{onClick:()=>o(!1),className:"bg-green-600",children:"OK"})})]})})]})]})}export{W as default};
