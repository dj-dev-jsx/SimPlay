import{r as i,j as e,H,L as E,c as v}from"./app-CUU1iLzl.js";import{T as L}from"./TeacherLayout-DdIjbJZ9.js";import{D as o,a as p,b as h,c as x,d as N}from"./dialog-UDe7vynf.js";import{B as a}from"./button-c-kbW1Cp.js";import{P as M}from"./plus-CyES-LQz.js";import{c as P}from"./user-DyYaZDJY.js";import{S as B,T as R}from"./trash-W0KKL0ha.js";import"./log-out-BDzL6a4i.js";const q=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"m9 9.5 2 2 4-4",key:"1dth82"}]],$=P("book-check",q);function W({classroom:u,activities:C}){const[A,m]=i.useState(C||[]),[w,f]=i.useState(!1),[k,g]=i.useState(!1),[O,n]=i.useState(!1),[S,r]=i.useState(!1),[D,d]=i.useState(!1),[_,j]=i.useState(""),[s,c]=i.useState({id:null,title:"",category:"",image:null}),T=async()=>{try{const t=new FormData;t.append("title",s.title),t.append("category",s.category),s.image&&t.append("image",s.image);let l;s.id?(l=await v.post(route("teacher.update_activity",s.id),t,{headers:{"Content-Type":"multipart/form-data"}}),m(y=>y.map(b=>b.id===l.data.activity.id?l.data.activity:b)),j("Activity updated successfully!")):(l=await v.post(route("teacher.store_activity",u.id),t,{headers:{"Content-Type":"multipart/form-data"}}),m(y=>[l.data.activity,...y]),j("Activity added successfully!")),f(!1),g(!1),n(!1),d(!0),c({id:null,title:"",category:"",image:null})}catch(t){console.error(t),alert("Failed to save activity.")}},F=async()=>{try{await v.delete(route("teacher.delete_activity",s.id)),m(t=>t.filter(l=>l.id!==s.id)),r(!1),j("Activity deleted successfully!"),d(!0)}catch(t){console.error(t),alert("Failed to delete activity.")}};return e.jsxs(L,{children:[e.jsx(H,{title:`${u.name} – Activities`}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-green-700",children:[u.name," – Activities"]}),e.jsx("p",{className:"text-gray-600",children:"Manage class activities"})]}),e.jsxs(a,{onClick:()=>f(!0),className:"bg-green-600 hover:bg-green-700 flex gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),"Add Activity"]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:A.map(t=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[e.jsx("img",{src:`/${t.image_path}`,className:"h-48 w-full object-cover"}),e.jsxs("div",{className:"p-4 flex flex-col gap-2",children:[e.jsx("h2",{className:"font-semibold text-green-800",children:t.title}),e.jsx("span",{className:"text-xs font-semibold text-green-600 uppercase",children:t.category?.replace("_"," ")}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[t.category!=="reference"&&e.jsx(a,{asChild:!0,className:"w-full sm:flex-1 bg-purple-600 flex items-center justify-center gap-1",children:e.jsxs(E,{href:route("teacher.activity.records",t.id),children:[e.jsx($,{className:"h-4 w-4"}),"Records"]})}),e.jsxs(a,{onClick:()=>{c({id:t.id,title:t.title,category:t.category??"",image:null}),g(!0)},className:"w-full sm:flex-1 bg-yellow-500 flex items-center justify-center gap-1",children:[e.jsx(B,{className:"h-4 w-4"}),"Edit"]}),e.jsxs(a,{onClick:()=>{c({id:t.id}),r(!0)},className:"w-full sm:flex-1 bg-red-600 flex items-center justify-center gap-1",children:[e.jsx(R,{className:"h-4 w-4"}),"Delete"]})]})]})]},t.id))}),e.jsx(o,{open:w||k,onOpenChange:()=>{f(!1),g(!1)},children:e.jsxs(p,{children:[e.jsx(h,{children:e.jsx(x,{children:s.id?"Edit Activity":"Add Activity"})}),e.jsxs("form",{onSubmit:t=>{t.preventDefault(),n(!0)},className:"space-y-4",children:[e.jsx("input",{className:"w-full border rounded-lg p-2",placeholder:"Activity Title",value:s.title,onChange:t=>c({...s,title:t.target.value}),required:!0}),e.jsxs("select",{className:"w-full border rounded-lg p-2",value:s.category,onChange:t=>c({...s,category:t.target.value}),children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"pre_activity",children:"Pre-Activity"}),e.jsx("option",{value:"concept_activity",children:"Concept Activity"}),e.jsx("option",{value:"application",children:"Application"}),e.jsx("option",{value:"reference",children:"Reference"})]}),e.jsx("input",{type:"file",accept:"image/*",onChange:t=>c({...s,image:t.target.files[0]})}),e.jsx(a,{type:"submit",className:"w-full bg-green-600",children:s.id?"Update Activity":"Save Activity"})]})]})}),e.jsx(o,{open:O,onOpenChange:n,children:e.jsxs(p,{children:[e.jsx(h,{children:e.jsx(x,{children:"Confirm Action"})}),e.jsx("p",{children:"Are you sure you want to proceed?"}),e.jsxs(N,{className:"flex justify-end gap-2",children:[e.jsx(a,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsx(a,{onClick:T,className:"bg-green-600",children:"Confirm"})]})]})}),e.jsx(o,{open:S,onOpenChange:r,children:e.jsxs(p,{children:[e.jsx(h,{children:e.jsx(x,{children:"Delete Activity"})}),e.jsx("p",{children:"This action cannot be undone."}),e.jsxs(N,{className:"flex justify-end gap-2",children:[e.jsx(a,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(a,{onClick:F,className:"bg-red-600",children:"Delete"})]})]})}),e.jsx(o,{open:D,onOpenChange:d,children:e.jsxs(p,{children:[e.jsx(h,{children:e.jsx(x,{children:"Success"})}),e.jsx("p",{children:_}),e.jsx(N,{className:"flex justify-end",children:e.jsx(a,{onClick:()=>d(!1),className:"bg-green-600",children:"OK"})})]})})]})]})}export{W as default};
